<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <title>Browser_Storage Example</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <script src="assets/javascript-modules/browser-storage/browser-storage.js" type="text/javascript"></script>
    <link type="text/css" href="assets/css/main.css" rel="stylesheet"/>

    <script type="text/javascript">
      const storage = new Browser_Storage();
      if (storage.storage_available != true) throw new Error('We may never have any memory of this...');


      function restore_settings() {
        let privacy_notice_read = storage.get('checkbox__privacy_notice');
        if (privacy_notice_read != 'true' && privacy_notice_read != true) return false;

        document.getElementById('trigger__privacy_notice').checked = true;
        return true;
      }


      function store_settings() {
        let privacy_notice_read = storage.get('checkbox__privacy_notice');
        if (privacy_notice_read != 'true' && privacy_notice_read != true)       return false;
        if (document.getElementById('trigger__privacy_notice').checked != true) return false;

        storage.set('checkbox__privacy_notice', true, 365);
        return true;
      }


      function toggle_privacy_notice(input_element) {
        if (input_element.checked == true) {
          storage.set('checkbox__privacy_notice', input_element.checked, 365);
          return true;
        }
        storage.remove('checkbox__privacy_notice');
        storage.clear();
        return false;
      }
    </script>
  </head>

  <body onload="restore_settings();" onunload="store_settings();">
    <div class="container__main_content">
      <p>
        This is a static site that provides the illusion of remembering a client.
        Test by accepting the <i>privacy notice</i> and then refreshing or
        closing and re-opening a tab pointing to the current URL.
      </p>

      <p>
        <kbd>Ctrl</kbd> <kbd>R</kbd> or <kbd>Ctrl</kbd> <kbd>Shift</kbd> <kbd>R</kbd>
        will refresh most desktop browsers.
      </p>

      <p>
        Then reject the privacy notice by clicking on the Acceptable button
        again to revert the behavior of this site.
      </p>

      <p>
        Use <kbd>Ctrl</kbd> <kbd>Shift</kbd> <kbd>I</kbd> to open debugger on a
        desktop browser, then navigate to the Storage tab/pane to observe
        JavaScript doing things for the above mentioned actions.
      </p>
    </div>

    <input type="checkbox"
           name="checkbox__privacy_notice"
           class="hidden__input privacy_notice__checkbox"
           id="trigger__privacy_notice"
           onchange="toggle_privacy_notice(this);">
    <div class="container__privacy_notice">
      <p>
        This site uses JavaScript, and localStorage or cookies of your browser,
        to enhance your experience here, however, this site currently does
        <strong>not</strong> store any data about your activity severer-side.
      </p>

      <p>
        Review the <a href="https://github.com/javascript-utilities/browser-storage#privacy">Privacy</a>
        and <a href="https://github.com/javascript-utilities/browser-storage#security">Security</a>
        notices regarding the
        <a href="https://github.com/javascript-utilities/browser-storage/blob/master/browser-storage.js">
          browser-storage.js
        </a>, for more details on how client-side storage and scripting are utilized.
      </p>
      <label for="trigger__privacy_notice"
             class="menu__trigger__label privacy_notice__label"
             title="Click to toggle."
             value="false"
             checked="true"
             >Acceptable: </label>
    </div>
  </body>

  <!-- License
    Browser Storage index.html example is apart of a submodule for Git tracked web sites
    Copyright (C) 2019  S0AndS0

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published
    by the Free Software Foundation; version 3 of the License.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->
</html>
